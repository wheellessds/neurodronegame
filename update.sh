#!/bin/bash

# Neuro's Drone Delivery Service - Auto Update Script
# ä½¿ç”¨æ–¹å¼: ./update.sh

echo "==========================================="
echo "ğŸš€ é–‹å§‹åŸ·è¡Œä¼ºæœå™¨è‡ªå‹•æ›´æ–°..."
echo "==========================================="

# 1. å¼·åˆ¶åŒæ­¥æœ€æ–°ä»£ç¢¼ (Force Pull)
# ä½¿ç”¨ fetch + reset ç¢ºä¿èˆ‡ GitHub å®Œå…¨ä¸€è‡´ï¼Œé¿å…æœ¬åœ°è¡çª
echo "ğŸ“¥ [1/4] åŒæ­¥ GitHub æœ€æ–°ä»£ç¢¼..."
git fetch --all
git reset --hard origin/main

# 2. æ›´æ–°ä¾è³´å¥—ä»¶
echo "ğŸ“¦ [2/4] æ›´æ–°ä¾è³´å¥—ä»¶ (npm install)..."
npm install

# 3. é‡æ–°ç·¨è­¯å‰ç«¯
echo "ğŸ—ï¸  [3/4] é‡æ–°ç·¨è­¯å°ˆæ¡ˆ (npm run build)..."
npm run build

# 4. é‡å•Ÿæœå‹™
echo "ğŸ”„ [4/4] é‡å•ŸéŠæˆ²æœå‹™ (pm2 restart)..."
pm2 restart neuro-game

echo "==========================================="
echo "âœ… æ›´æ–°å®Œæˆï¼ç¾åœ¨ä¼ºæœå™¨å·²æ˜¯æœ€æ–°ç‰ˆæœ¬ã€‚"
echo "==========================================="
